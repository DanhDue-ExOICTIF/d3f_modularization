name: d3f_modularization

packages:
  - d3f_core/**
  - d3f_dependency_manager/**
  - d3f_inapp_purchase/**
  - d3f_login/**
  - d3f_modular/**
  - d3f_networking/**
  - d3f_shared/**

ide:
  intellij: true
  vscode: true

command:
  bootstrap:
    # NOTE: https://github.com/invertase/melos/issues/117#issuecomment-1125224468
    # A workaround is to run melos clean before melos publish,
    # which removes pubspec_overrides.yamls if they were generated by Melos.
    usePubspecOverrides: true

scripts:
  pub:upgrade:
    run: |
      melos exec -- fvm flutter pub upgrade
      
  pub:get:
    run: |
      melos exec -- fvm flutter pub get

  analyze: dart analyze

  format: bash ./scripts/dartfmt.sh

  unit:test:
    run: melos exec -- dart test
    select-package:
      dir-exists: test

  build_runner:
    run: |
      melos exec \
      -- fvm flutter pub run build_runner build --delete-conflicting-outputs
    select-package:
      depends-on: 'build_runner'

  fluttergen:
    run: |
      melos exec \
      -- fluttergen -c pubspec.yaml
    select-package:
      depends-on: 'flutter_gen_runner'
    